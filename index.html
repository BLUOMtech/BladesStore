<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Blade Designs</title>
<style>
body{font-family:sans-serif;margin:0;background:#f6f6f6}
nav{position:sticky;top:0;background:#fff;padding:15px;box-shadow:0 2px 5px rgba(0,0,0,.1);display:flex;justify-content:space-between}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;padding:20px}
.card{background:#fff;border-radius:12px;box-shadow:0 4px 8px rgba(0,0,0,.08);padding:15px;text-align:center}
.card img{width:100%;border-radius:10px}
button{padding:10px;border:none;border-radius:8px;background:#222;color:#fff;margin-top:8px;cursor:pointer}
#cart{position:fixed;right:0;top:0;width:320px;height:100%;background:#fff;box-shadow:-3px 0 8px rgba(0,0,0,.2);padding:20px;overflow:auto;transform:translateX(100%);transition:.3s}
#cart.open{transform:translateX(0)}
.box{background:#fafafa;padding:10px;border-radius:10px;margin-top:10px;font-size:14px}
</style>
</head>
<body>

<nav>
<b>Blade Designs</b>
<button onclick="toggleCart()">Cart (<span id="cartCount">0</span>)</button>
</nav>

<div class="grid" id="shop"></div>

<div id="cart">
<h3>Your Cart</h3>
<div id="cartItems"></div>
<p><b>Total: $<span id="total">0</span></b></p>
<button onclick="checkout()">Checkout</button>

<div id="payBox" class="box" style="display:none">
  <h4>PayID Payment</h4>
  <p><b>PayID:</b> bladepeisker82@gmail.com</p>
  <p><b>Reference:</b> <span id="orderRef"></span></p>
  <p>Send payment, then click below:</p>
  <button onclick="placeOrder()">I Have Paid</button>
</div>
</div>

<script>
// ----- CART -----
let cart = JSON.parse(localStorage.getItem("cart")||"[]");
function saveCart(){localStorage.setItem("cart",JSON.stringify(cart)); updateCartUI();}
function toggleCart(){document.getElementById("cart").classList.toggle("open");}

function updateCartUI(){
  document.getElementById("cartCount").innerText = cart.reduce((a,b)=>a+b.qty,0);
  let items="", total=0;
  cart.forEach(i=>{total+=i.price*i.qty; items+=`${i.title} x ${i.qty}<br>`;});
  document.getElementById("cartItems").innerHTML=items;
  document.getElementById("total").innerText=total;
}

function addToCart(p){
  let i=cart.find(x=>x.id===p.id);
  if(i)i.qty++; else cart.push({...p,qty:1});
  saveCart();
}

// ----- PRODUCTS -----
function getProducts(){return JSON.parse(localStorage.getItem("products")||"[]");}

function renderShop(){
  let html="";
  getProducts().forEach(p=>{
    html+=`
    <div class="card">
      <img src="${p.image}">
      <h4>${p.title}</h4>
      <p>$${p.price}</p>
      <button onclick='addToCart(${JSON.stringify(p)})'>Add to Cart</button>
    </div>`;
  });
  document.getElementById("shop").innerHTML=html;
}

// ----- CHECKOUT -----
function checkout(){
  const ref="ORDER-"+Date.now();
  document.getElementById("orderRef").innerText=ref;
  document.getElementById("payBox").style.display="block";
  localStorage.setItem("currentOrderRef",ref);
}

function placeOrder(){
  const orders=JSON.parse(localStorage.getItem("orders")||"[]");
  orders.push({
    ref: localStorage.getItem("currentOrderRef"),
    items: cart,
    paid:false
  });
  localStorage.setItem("orders",JSON.stringify(orders));
  alert("Order placed! Tell the owner your reference.");
  cart=[];
  saveCart();
  document.getElementById("payBox").style.display="none";
}

// ----- INITIALIZE -----
renderShop();
updateCartUI();
</script>

</body>
</html>
